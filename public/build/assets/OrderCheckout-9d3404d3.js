import{q as Y,r as i,j as e,Y as J,a as V,b as z,y as B}from"./app-422c2137.js";import{H as K}from"./HomeLayout-81fdb6ae.js";import Q from"./DiscountCode-1cad544b.js";import"./react-toastify.esm-07e16aaa.js";import"./Header-72610feb.js";import"./Footer-50e07701.js";import"./InputError-f0d9cca6.js";function le({auth:l,data:N}){let b=Y().props.auth.csrf_token;const[n,v]=i.useState({shipping_full_name:l.user.name,shipping_mobile_no:l.user.mobile_no,shipping_address_line1:"",shipping_address_line2:"",shipping_landmark:"NA",shipping_city:"",shipping_pincode:"",shipping_district:"Thane",shipping_state:"",shipping_address_type:"Home",shipping_email:l.user.email,default_address_flag:!1}),{cart:f,user:U,shipping_address:C,shipping_addresses:k,cart_amounts:o,shipping_amount:F,payment_mode:D,order_delivery:W,increment_id:A,shipping_charges:S,grand_total:X,cod_rmk:x,cod_response:O,cod_charges:p}=N,[_,Z]=i.useState(p);console.log("rmk",x);const[t,w]=i.useState(F),[j,R]=i.useState(O=="Y"?1:0),[g,T]=i.useState(C.shipping_address_id),[d,G]=i.useState("");let c;d=="Cash On Delivery"?c=parseFloat(o.cart.cart_discounted_total+t+Number(p)).toFixed(2):c=parseFloat(o.cart.cart_discounted_total+t).toFixed(2);const m=parseFloat(o.total_gst).toFixed(2);parseFloat(o.cart.cart_discounted_total-m+o.product_discount-c).toFixed(2);const I=s=>{console.log("cod_response_null"),z.get("/orders/calculaterate/"+s).then(a=>{w(a.data.shipping_amount),R(a.data.cod_response),console.log("cod_response",a)})},r=s=>{const{name:a,value:H,type:L,checked:q}=s.target;v({...n,[a]:L==="checkbox"?q:H})};i.useEffect(()=>{d=="Cash On Delivery"&&y(s=>(Number(s)+Number(_)).toFixed(2))},[d]);const M=s=>{s.preventDefault(),B.post(route("address.store"),n,{onSuccess:()=>{console.log("Address submitted successfully")},onError:a=>{console.error("Validation Errors: ",a)}})},[h,y]=i.useState(c),[P,$]=i.useState(""),[u,E]=i.useState(0);return e.jsxs(K,{auth:l,children:[e.jsx(J,{title:"Place Order"}),e.jsx("div",{className:"sub-banner bg-light pb-0",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-sm-12",children:e.jsxs("div",{className:"banner_heading pb-4",children:[e.jsx("h2",{children:"Checkout"}),e.jsxs("p",{children:[l.cart_count," Items"]})]})})})})}),e.jsx("section",{className:"checkout bg-light",children:e.jsx("div",{className:"container",children:e.jsx("form",{action:"",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-sm-7",children:[e.jsxs("div",{className:"checkout-form pt-5 d-flex align-items-center",children:[e.jsx("h4",{className:"mb-0",children:"Address Details"}),e.jsxs(V,{href:"/profile/view",type:"button",className:"btn add-new-address-btn",children:[e.jsx("i",{className:"fas fa-plus-circle"})," Add New Address"]})]}),e.jsxs("div",{className:"checkout-form mt-4 payment-details",children:[e.jsx("h4",{className:"",children:"Select Address"}),e.jsx("div",{className:"row",children:k.map(s=>e.jsx("div",{className:"col-sm-12",children:e.jsxs("div",{className:"form-check payment-radio-btn",children:[e.jsx("input",{onClick:()=>{T(s.shipping_address_id),I(s.shipping_address_id)},checked:s.shipping_address_id==g,className:"form-check-input",type:"radio",name:"flexRadioDefault",id:"flexRadioDefault2"+s.shipping_address_id}),e.jsx("label",{className:"form-check-label",htmlFor:"flexRadioDefault2"+s.shipping_address_id,children:`${s.shipping_address_line1}, ${s.shipping_address_line2}, ${s.shipping_city}, ${s.shipping_state}, ${s.shipping_pincode}`})]})},s.shipping_address_id))})]}),e.jsxs("div",{className:"checkout-form mt-4 payment-details",children:[e.jsx("h4",{className:"",children:"Payment"}),e.jsx("p",{className:"mb-4",children:"All transactions are secure and encrypted."}),e.jsx("div",{className:"row",children:D.map((s,a)=>e.jsx("div",{className:"col-sm-12",children:e.jsxs("div",{className:"form-check payment-radio-btn",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"paymentRadioDefault",id:`paymentMode${s.payment_mode_id}`,disabled:s.payment_mode_name=="Cash On Delivery"&&j==0,onClick:()=>G(s.payment_mode_name),defaultChecked:s.default_selected===1}),e.jsxs("div",{className:"d-flex payment-btn-img",children:[e.jsx("label",{className:"form-check-label",htmlFor:"flexRadioDefault"+a,children:s.payment_mode_name=="Cash On Delivery"&&j==0?x:s.payment_mode_name}),s.payment_mode_name!="Cash On Delivery"&&e.jsxs("div",{children:[e.jsx("img",{src:"/assets/images/payment/visa.png"}),e.jsx("img",{src:"/assets/images/payment/maestro.png"}),e.jsx("img",{src:"/assets/images/payment/mastercard.png"}),e.jsx("img",{src:"/assets/images/payment/amex.png"}),e.jsx("button",{type:"button",children:"+4"})]})]})]})}))})]})]}),e.jsx("div",{className:"col-sm-5",children:e.jsxs("div",{className:"checkout-right",children:[f.map((s,a)=>e.jsxs("div",{className:"checkout-product mb-3",children:[e.jsxs("div",{className:"checkout-product_img position-relative",children:[e.jsx("img",{src:"/backend-assets/uploads/product_thumbs/"+s.products.product_thumb,alt:""}),e.jsx("p",{children:s.qty})]}),e.jsxs("div",{className:"checkout-product_content",children:[e.jsx("h5",{children:s.products.product_title}),e.jsx("p",{})]}),e.jsx("div",{className:"checkout-product_price",children:e.jsxs("p",{children:["₹",s.product_variant_id?s.product_variant.product_price:s.products.product_price,".00"]})})]})),e.jsx(Q,{setCouponCode1:$,setCouponDiscount:E,paymentMode:d,gstCharges:m,shippingAmount:t,codCharges:Number(p).toFixed(2),finalGrandTotal:h,setFinalGrandTotal:y}),e.jsxs("div",{className:"payment-history mt-5",children:[e.jsxs("div",{className:"payment-display mb-2",children:[e.jsx("p",{children:"Gst Charges"}),e.jsxs("p",{children:["₹",m]})]}),e.jsxs("div",{className:"payment-display mb-2",children:[e.jsxs("p",{children:["Subtotal . ",l.cart_count," Items"]}),e.jsxs("p",{children:["₹",d=="Cash On Delivery"?c-parseFloat(t).toFixed(2)-Number(p):c-parseFloat(t).toFixed(2)]})]}),e.jsxs("div",{className:"payment-display mb-3",children:[e.jsx("p",{children:"Shipping"}),e.jsxs("p",{children:["₹",parseFloat(t).toFixed(2)]})]}),e.jsxs("div",{className:"payment-display mb-3",children:[e.jsx("p",{children:"COD Charges"}),e.jsxs("p",{children:["₹",d=="Cash On Delivery"?Number(_).toFixed(2):0]})]}),u!=0&&e.jsxs("div",{className:"payment-display mb-3",children:[e.jsx("p",{children:"Coupon Discount"}),e.jsxs("p",{children:["- ₹",u]})]}),e.jsxs("div",{className:"payment-display",children:[e.jsx("p",{children:e.jsx("b",{children:"Total"})}),e.jsx("p",{children:e.jsxs("b",{children:["₹",h]})})]})]}),e.jsxs("form",{action:"/order/place",method:"POST",children:[e.jsx("input",{type:"hidden",name:"_token",value:b}),e.jsx("input",{type:"hidden",name:"amount",value:h}),e.jsx("input",{type:"hidden",name:"shipping_amount",value:t}),e.jsx("input",{type:"hidden",name:"txnid",value:A||""}),e.jsx("input",{type:"hidden",name:"shipping_charges",value:JSON.stringify(S||{})}),e.jsx("input",{type:"hidden",name:"shipping_id",value:g}),e.jsx("input",{type:"hidden",name:"paymentmode",value:d}),e.jsx("input",{type:"hidden",name:"couponcode",value:P}),e.jsx("input",{type:"hidden",name:"coupondiscount",value:u}),e.jsx("div",{className:"pay-now-button",children:e.jsx("button",{type:"submit",children:"Pay now & Confirm Order"})})]})]})})]})})})}),e.jsx("div",{className:"modal fade",id:"exampleModal",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog add-address-form",children:e.jsxs("div",{className:"modal-content bg-light py-2",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-center m-auto",id:"exampleModalLabel",children:"Add new Address"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",children:e.jsx("i",{className:"far fa-times"})})]}),e.jsxs("form",{action:"",onSubmit:M,children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"row",action:"",children:[e.jsx("div",{className:"col-sm-12",children:e.jsx("div",{className:"form-inputs mb-3",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Address",id:"shipping_address_line1",name:"shipping_address_line1",value:n.shipping_address_line1,onChange:r})})}),e.jsx("div",{className:"col-sm-12",children:e.jsx("div",{className:"form-inputs mb-3",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Apartment (Optional)",id:"shipping_address_line2",name:"shipping_address_line2",value:n.shipping_address_line2,onChange:r})})}),e.jsx("div",{className:"col-sm-6",children:e.jsx("div",{className:"form-inputs mb-3",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"City",id:"shipping_city",name:"shipping_city",value:n.shipping_city,onChange:r})})}),e.jsx("div",{className:"col-sm-6",children:e.jsx("div",{className:"form-inputs mb-3",children:e.jsx("input",{type:"number",className:"form-control",placeholder:"Post Code",id:"shipping_pincode",name:"shipping_pincode",value:n.shipping_pincode,onChange:r})})}),e.jsx("div",{className:"col-sm-6",children:e.jsx("div",{className:"form-inputs",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Country/Region",id:"shipping_state",name:"shipping_state",value:n.shipping_state,onChange:r})})}),e.jsx("div",{className:"col-sm-6",children:e.jsx("div",{className:"form-inputs",children:e.jsx("input",{type:"number",className:"form-control",placeholder:"Alternate Contact Number",id:"exampleAddress"})})})]})}),e.jsxs("div",{className:"modal-footer m-auto border-0",children:[e.jsx("button",{type:"submit",className:"btn button black",children:"Add Address"}),e.jsx("button",{type:"button",className:"button cancel_btn black","data-bs-dismiss":"modal",children:"Cancel"})]})]})]})})})]})}export{le as default};
