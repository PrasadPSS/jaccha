import{q as N,r as n,j as s,Y as v,a as g,b as u,y as _}from"./app-110da61b.js";import"./Dropdown-8cf8df9b.js";import{H as f}from"./HomeLayout-2918b9ca.js";import{B as k}from"./react-toastify.esm-4f62db88.js";import"./Header-0095ab83.js";import"./Footer-9dcce443.js";import"./InputError-312d8c85.js";function B({auth:i,cart:d,cart_amount:h}){let p=N().props.auth.csrf_token,o=[];d&&d.forEach(t=>{o.push({id:t.product_id,weight:t.products.product_weight,swt:t.sweetness_level,addons:t.ingredient_addons,excl:t.ingredient_exclusions,name:t.product_variant!=null?t.product_variant.product_title:t.products.product_title,description:t.products.product_sub_title,price:t.product_variant!=null?t.product_variant.product_price:t.products.product_price,quantity:t.qty,image:t.products.product_thumb})});const[l,m]=n.useState(h),[c,r]=n.useState(o);n.useEffect(()=>{let t=c.reduce((a,e)=>a+e.price*e.quantity,0);m(t)},[c]);const x=async t=>{await fetch("/api/cart/increase",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":p},body:JSON.stringify({item_id:t})}).then(a=>a.json()).then(a=>{r(c.map(e=>e.id===t?{...e,quantity:Number(e.quantity)+1}:e))}).catch(a=>console.error(a))},j=async t=>{r(c.map(a=>a.id===t&&a.quantity>1?{...a,quantity:a.quantity-1}:a));try{const a=await u.post("/api/cart/decrease",{item_id:t});r(c.map(e=>e.id===t?{...e,quantity:a.data.updated_quantity}:e))}catch(a){console.error("Error decreasing quantity:",a)}},b=async t=>{r(c.filter(a=>a.id!==t));try{await u.post("/api/cart/remove",{item_id:t}),r(c.filter(a=>a.id!==t))}catch(a){console.error("Error removing item:",a)}k.success("Product Removed Successfully",{autoClose:5e3})},y=async()=>{_.get("/checkout/payment",{onSuccess:()=>alert("Order Placed Successfully"),onError:t=>console.error(t)})};return s.jsxs(f,{auth:i,header:s.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Dashboard"}),children:[s.jsx(v,{title:"Cart"}),c.length==0&&s.jsxs("div",{className:"sub-banner bg-light pb-0",children:[s.jsx("div",{className:"container",children:s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-sm-12",children:s.jsxs("div",{className:"banner_heading pb-4",children:[s.jsx("h2",{children:"My Basket"}),s.jsx("p",{children:"0 Items"})]})})})}),s.jsxs("div",{className:"empty-cart-content",children:[s.jsx("img",{src:"/assets/images/empty-wishlist.png",alt:"Empty Cart",className:"img-fluid mb-4",style:{maxWidth:"200px"}}),s.jsx("h1",{children:"Oops! Fill Your Basket with Care! ðŸ‘©â€ðŸ‘§ðŸ’›"}),s.jsx("p",{className:"mt-2",children:"Your shopping basket is empty. Start adding items to it!"}),s.jsx(g,{as:"button",href:"/products",className:"button mt-4",children:"Explore Our Products"})]})]}),c.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"sub-banner bg-light pb-0",children:s.jsx("div",{className:"container",children:s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-sm-12",children:s.jsxs("div",{className:"banner_heading pb-4",children:[s.jsx("h2",{children:"My Basket"}),s.jsxs("p",{children:[i.cart_count," Items"]})]})})})})}),s.jsx("section",{className:"checkout bg-light cart",children:s.jsx("div",{className:"container",children:s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-sm-12",children:s.jsxs("div",{className:"checkout-right",children:[c.length>0?c.map(t=>s.jsxs("div",{className:"checkout-product mb-5",children:[s.jsxs("div",{className:"cart-product_image",children:[s.jsx("div",{className:"checkout-product_img position-relative",children:s.jsx("img",{src:"/backend-assets/uploads/product_thumbs/"+t.image,alt:""})}),s.jsxs("div",{className:"cart-product_content",children:[s.jsxs("div",{className:"checkout-product_content",children:[s.jsx("h5",{children:t.name}),s.jsx("p",{})]}),s.jsx("div",{className:"checkout-product_price",children:s.jsxs("p",{children:["â‚¹",t.price]})})]})]}),s.jsxs("div",{className:"add-to-card-btn",children:[s.jsx("button",{type:"button",onClick:()=>x(t.id),className:"btn plus_button plus",id:"plus-btn1",children:"+"}),s.jsx("div",{className:"number",children:s.jsx("button",{type:"button",className:"btn black","data-bs-toggle":"modal","data-bs-target":"#addBasketModal",children:s.jsx("span",{id:"count1",children:t.quantity})})}),s.jsx("button",{onClick:()=>j(t.id),type:"button",className:"btn minus_button",id:"minus-btn1",children:"-"})]}),s.jsx("a",{href:"#",onClick:()=>b(t.id),children:s.jsxs("p",{className:"cart_remove",children:[s.jsx("i",{className:"far fa-trash-alt"}),"Remove"]})})]},t.id)):"Cart is Empty",s.jsxs("div",{className:"payment-history mt-5",children:[s.jsxs("div",{className:"payment-display mb-2",children:[s.jsxs("p",{children:["Subtotal . ",i.cart_count," Items"]}),s.jsxs("p",{children:["â‚¹",l]})]}),s.jsxs("div",{className:"payment-display",children:[s.jsx("p",{children:s.jsx("b",{children:"Total"})}),s.jsx("p",{children:s.jsxs("b",{children:["â‚¹",l]})})]})]}),s.jsx("div",{className:"pay-now-button",children:s.jsx("button",{onClick:()=>y(),children:"Checkout"})})]})})})})})]})]})}export{B as default};
