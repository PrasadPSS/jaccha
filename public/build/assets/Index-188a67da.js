import{q as F,r,j as s,Y as P,a as T,y as b,b as N}from"./app-4511fce2.js";import"./Dropdown-28ee4a7a.js";import{H}from"./HomeLayout-3591e35d.js";import{B as R}from"./react-toastify.esm-26a6dfb9.js";import{I as d}from"./InputError-b23f004c.js";import"./Header-108a78c7.js";import"./Footer-51e9d680.js";function G({auth:m,cart:u,cart_amount:v,isProfileCompleted:x,districts:j}){let f=F().props.auth.csrf_token;const y=j.filter((e,a,i)=>a===i.findIndex(h=>h.state_name===e.state_name)),[t,k]=r.useState({shipping_full_name:"",shipping_mobile_no:"",shipping_address_line1:"",shipping_address_line2:"",shipping_landmark:"",shipping_city:"",shipping_pincode:"",shipping_district:"",shipping_state:"",shipping_address_type:"",shipping_email:"",default_address_flag:!1}),[l,C]=r.useState(""),[p,S]=r.useState(""),[E,W]=r.useState(y),[w,A]=r.useState([]),n=e=>{const{name:a,value:i,type:h,checked:B}=e.target;k({...t,[a]:h==="checkbox"?B:i}),a=="shipping_state"&&S(i),a=="shipping_district"&&setSelectedDistrict(i)};r.useEffect(()=>A(j.filter(e=>e.state_name==p)),[p]);const q=e=>{e.preventDefault(),b.post(route("address.store"),t,{onSuccess:()=>{console.log("Address submitted successfully"),$("#exampleModal").modal("hide")},onError:a=>(C(a),!1)})};let g=[];u&&u.forEach(e=>{g.push({id:e.product_id,weight:e.products.product_weight,swt:e.sweetness_level,addons:e.ingredient_addons,excl:e.ingredient_exclusions,name:e.product_variant!=null?e.product_variant.product_title:e.products.product_title,description:e.products.product_sub_title,price:e.product_variant!=null?e.product_variant.product_price:e.products.product_price,quantity:e.qty,image:e.products.product_thumb})});const[_,I]=r.useState(v),[c,o]=r.useState(g);r.useEffect(()=>{let e=c.reduce((a,i)=>a+i.price*i.quantity,0);I(e)},[c]);const D=async e=>{await fetch("/api/cart/increase",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":f},body:JSON.stringify({item_id:e})}).then(a=>a.json()).then(a=>{o(c.map(i=>i.id===e?{...i,quantity:Number(i.quantity)+1}:i))}).catch(a=>console.error(a))},M=async e=>{o(c.map(a=>a.id===e&&a.quantity>1?{...a,quantity:a.quantity-1}:a));try{const a=await N.post("/api/cart/decrease",{item_id:e});o(c.map(i=>i.id===e?{...i,quantity:a.data.updated_quantity}:i))}catch(a){console.error("Error decreasing quantity:",a)}},O=async e=>{o(c.filter(a=>a.id!==e));try{await N.post("/api/cart/remove",{item_id:e}),o(c.filter(a=>a.id!==e))}catch(a){console.error("Error removing item:",a)}R.success("Product Removed Successfully",{autoClose:5e3})},L=async()=>{b.get("/checkout/payment",{onSuccess:()=>alert("Order Placed Successfully"),onError:e=>console.error(e)})};return s.jsxs(H,{auth:m,header:s.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Dashboard"}),children:[s.jsx(P,{title:"Cart"}),c.length==0&&s.jsxs("div",{className:"sub-banner bg-light pb-0",children:[s.jsx("div",{className:"container",children:s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-sm-12",children:s.jsxs("div",{className:"banner_heading pb-4",children:[s.jsx("h2",{children:"My Basket"}),s.jsx("p",{children:"0 Items"})]})})})}),s.jsxs("div",{className:"empty-cart-content",children:[s.jsx("img",{src:"/assets/images/empty-wishlist.png",alt:"Empty Cart",className:"img-fluid mb-4",style:{maxWidth:"200px"}}),s.jsx("h1",{children:"Oops! Fill Your Basket with Care! 👩‍👧💛"}),s.jsx("p",{className:"mt-2",children:"Your shopping basket is empty. Start adding items to it!"}),s.jsx(T,{as:"button",href:"/products",className:"button mt-4",children:"Explore Our Products"})]})]}),c.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"sub-banner bg-light pb-0",children:s.jsx("div",{className:"container",children:s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-sm-12",children:s.jsxs("div",{className:"banner_heading pb-4",children:[s.jsx("h2",{children:"My Basket"}),s.jsxs("p",{children:[m.cart_count," Items"]})]})})})})}),s.jsx("section",{className:"checkout bg-light cart",children:s.jsx("div",{className:"container",children:s.jsx("div",{className:"row",children:s.jsx("div",{className:"col-sm-12",children:s.jsxs("div",{className:"checkout-right",children:[c.length>0?c.map(e=>s.jsxs("div",{className:"checkout-product mb-5",children:[s.jsxs("div",{className:"cart-product_image",children:[s.jsx("div",{className:"checkout-product_img position-relative",children:s.jsx("img",{src:"/backend-assets/uploads/product_thumbs/"+e.image,alt:""})}),s.jsxs("div",{className:"cart-product_content",children:[s.jsxs("div",{className:"checkout-product_content",children:[s.jsx("h5",{children:e.name}),s.jsx("p",{})]}),s.jsx("div",{className:"checkout-product_price",children:s.jsxs("p",{children:["₹",e.price]})})]})]}),s.jsxs("div",{className:"add-to-card-btn",children:[s.jsx("button",{type:"button",onClick:()=>D(e.id),className:"btn plus_button plus",id:"plus-btn1",children:"+"}),s.jsx("div",{className:"number",children:s.jsx("button",{type:"button",className:"btn black","data-bs-toggle":"modal","data-bs-target":"#addBasketModal",children:s.jsx("span",{id:"count1",children:e.quantity})})}),s.jsx("button",{onClick:()=>M(e.id),type:"button",className:"btn minus_button",id:"minus-btn1",children:"-"})]}),s.jsx("a",{href:"#",onClick:()=>O(e.id),children:s.jsxs("p",{className:"cart_remove",children:[s.jsx("i",{className:"far fa-trash-alt"}),"Remove"]})})]},e.id)):"Cart is Empty",s.jsxs("div",{className:"payment-history mt-5",children:[s.jsxs("div",{className:"payment-display mb-2",children:[s.jsxs("p",{children:["Subtotal . ",m.cart_count," Items"]}),s.jsxs("p",{children:["₹",_]})]}),s.jsxs("div",{className:"payment-display",children:[s.jsx("p",{children:s.jsx("b",{children:"Total"})}),s.jsx("p",{children:s.jsxs("b",{children:["₹",_]})})]})]}),x&&s.jsx("div",{className:"pay-now-button",children:s.jsx("button",{onClick:()=>L(),children:"Checkout"})}),!x&&s.jsx("div",{className:"pay-now-button",children:s.jsxs("button",{type:"button",className:" ","data-bs-toggle":"modal","data-bs-target":"#exampleModal",children:[s.jsx("i",{className:"fas fa-plus-circle"})," Add New Address"]})})]})})})})}),s.jsx("div",{className:"modal fade address-modal",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:s.jsx("form",{onSubmit:q,className:"modal-dialog add-address-form",children:s.jsxs("div",{className:"modal-content bg-light py-2",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h5",{className:"modal-title text-center m-auto",id:"exampleModalLabel",children:"Add Shipping Address"}),s.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",children:s.jsx("i",{className:"far fa-times"})})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-sm-6",children:s.jsxs("div",{className:"form-inputs mb-3",children:[s.jsx("input",{type:"text",className:"form-control",placeholder:"Full Name",id:"shipping_full_name",name:"shipping_full_name",value:t.shipping_full_name,onChange:n}),s.jsx(d,{message:l.shipping_full_name,className:"mt-2"})]})}),s.jsx("div",{className:"col-sm-6",children:s.jsxs("div",{className:"form-inputs mb-3",children:[s.jsx("input",{type:"number",className:"form-control",placeholder:"Contact Number",id:"shipping_mobile_no",name:"shipping_mobile_no",value:t.shipping_mobile_no,onChange:n}),s.jsx(d,{message:l.shipping_mobile_no,className:"mt-2"})]})}),s.jsx("div",{className:"col-sm-6",children:s.jsxs("div",{className:"form-inputs mb-3",children:[s.jsx("input",{type:"text",className:"form-control",placeholder:"Address Line 1",id:"shipping_address_line1",name:"shipping_address_line1",value:t.shipping_address_line1,onChange:n}),s.jsx(d,{message:l.shipping_address_line1,className:"mt-2"})]})}),s.jsx("div",{className:"col-sm-6",children:s.jsxs("div",{className:"form-inputs mb-3",children:[s.jsx("input",{type:"text",className:"form-control",placeholder:"Address Line 2",id:"shipping_address_line2",name:"shipping_address_line2",value:t.shipping_address_line2,onChange:n}),s.jsx(d,{message:l.shipping_address_line2,className:"mt-2"})]})}),s.jsx("div",{className:"col-sm-4",children:s.jsxs("div",{className:"form-inputs mb-3",children:[s.jsx("input",{type:"text",className:"form-control",placeholder:"Landmark",id:"shipping_landmark",name:"shipping_landmark",value:t.shipping_landmark,onChange:n}),s.jsx(d,{message:l.shipping_landmark,className:"mt-2"})]})}),s.jsx("div",{className:"col-sm-4",children:s.jsxs("div",{className:"form-inputs mb-3",children:[s.jsx("input",{type:"text",className:"form-control",placeholder:"City",id:"shipping_city",name:"shipping_city",value:t.shipping_city,onChange:n}),s.jsx(d,{message:l.shipping_city,className:"mt-2"})]})}),s.jsx("div",{className:"col-sm-4",children:s.jsxs("div",{className:"form-inputs mb-3",children:[s.jsx("input",{type:"number",className:"form-control",placeholder:"Pincode",id:"shipping_pincode",name:"shipping_pincode",value:t.shipping_pincode,onChange:n}),s.jsx(d,{message:l.shipping_pincode,className:"mt-2"})]})}),s.jsx("div",{className:"col-sm-4",children:s.jsxs("div",{className:"form-inputs mb-3",children:[s.jsxs("select",{className:"form-control",id:"shipping_state",name:"shipping_state",value:p,onChange:n,children:[s.jsx("option",{value:"",selected:!0,disabled:!0,children:"Select State"}),E.map(e=>s.jsx("option",{value:e.state_name,children:e.state_name}))]}),s.jsx(d,{message:l.shipping_state,className:"mt-2"})]})}),s.jsx("div",{className:"col-sm-4",children:s.jsxs("div",{className:"form-inputs mb-3",children:[s.jsxs("select",{className:"form-control",id:"shipping_district",name:"shipping_district",value:t.shipping_district,onChange:n,children:[s.jsx("option",{value:"",selected:!0,disabled:!0,children:"Select District"}),w.map(e=>s.jsx("option",{value:e.name,children:e.name}))]}),s.jsx(d,{message:l.shipping_district,className:"mt-2"})]})}),s.jsx("div",{className:"col-sm-4",children:s.jsxs("div",{className:"form-inputs mb-3",children:[s.jsx("input",{type:"text",className:"form-control",placeholder:"E-mail Address",id:"shipping_email",name:"shipping_email",value:t.shipping_email,onChange:n}),s.jsx(d,{message:l.shipping_email,className:"mt-2"})]})}),s.jsx("div",{className:"col-sm-6",children:s.jsxs("div",{className:"form-inputs mb-3",children:[s.jsxs("select",{className:"form-control",id:"shipping_address_type",name:"shipping_address_type",value:t.shipping_address_type,onChange:n,children:[s.jsx("option",{value:"",children:"Select Address Type"}),s.jsx("option",{value:"Home",children:"Home"}),s.jsx("option",{value:"Work",children:"Work"}),s.jsx("option",{value:"Other",children:"Other"})]}),s.jsx(d,{message:l.shipping_address_type,className:"mt-2"})]})}),s.jsx("div",{className:"col-sm-4",children:s.jsx("div",{className:"form-inputs mb-3",children:s.jsxs("label",{for:"defaultAddress",children:[s.jsx("input",{type:"checkbox",id:"default_address_flag",name:"default_address_flag",value:t.default_address_flag,onChange:n})," Set as Default Address"]})})})]})}),s.jsxs("div",{className:"modal-footer m-auto border-0",children:[s.jsx("button",{type:"submit",className:"btn button black",children:"Add Address"}),s.jsx("button",{type:"button",className:"button cancel_btn black","data-bs-dismiss":"modal",children:"Cancel"})]})]})})})]})]})}export{G as default};
